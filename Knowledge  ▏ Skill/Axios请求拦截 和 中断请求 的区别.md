
	é—®ï¼šå¦‚æœåœ¨è¯·æ±‚æ‹¦æˆªå™¨ä¸­ä½¿ç”¨return Promise.rejectèƒ½å¦å®ç°ä¸­æ–­è¯·æ±‚çš„åŠŸèƒ½ï¼Ÿ

ï¼šåœ¨ Axios çš„è¯·æ±‚æ‹¦æˆªå™¨ä¸­ï¼Œé€šè¿‡ `return Promise.reject` ç¡®å®å¯ä»¥ä¸­æ–­è¯·æ±‚ï¼Œä½†éœ€è¦æ˜ç¡®è¿™æ˜¯é€»è¾‘ä¸Šçš„ä¸­æ–­ï¼Œè€Œä¸æ˜¯å–æ¶ˆè¯·æ±‚ã€‚å…·ä½“è¡¨ç°æ˜¯æ‹¦æˆªå™¨ä¼šé˜»æ­¢è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ï¼Œå¹¶è§¦å‘é”™è¯¯å¤„ç†é€»è¾‘ã€‚

---

### **ä½¿ç”¨åœºæ™¯**

1. **è¯·æ±‚å‚æ•°æ ¡éªŒå¤±è´¥** å¦‚æœåœ¨æ‹¦æˆªå™¨ä¸­æ£€æµ‹åˆ°å‚æ•°æœ‰é—®é¢˜ï¼Œå¯ä»¥ç›´æ¥ä¸­æ–­è¯·æ±‚ï¼Œå¹¶è¿”å›é”™è¯¯ä¿¡æ¯ã€‚
    
2. **ç”¨æˆ·æœªæˆæƒ** æ¯”å¦‚ç”¨æˆ·æœªç™»å½•æˆ–æƒé™ä¸è¶³æ—¶ï¼Œå¯ä»¥ç›´æ¥æ‹¦æˆªè¯·æ±‚ã€‚
    

---

### **å®ç°ç¤ºä¾‹**

#### è¯·æ±‚æ‹¦æˆªå™¨ä¸­æ–­è¯·æ±‚çš„ä»£ç ï¼š

```javascript
import axios from 'axios';

const instance = axios.create();

// è¯·æ±‚æ‹¦æˆªå™¨
instance.interceptors.request.use(
  (config) => {
    // æ£€æŸ¥é€»è¾‘ï¼šå‡è®¾éœ€è¦ `authToken` å‚æ•°
    if (!config.headers['Authorization']) {
      // æ‹¦æˆªè¯·æ±‚å¹¶è¿”å›é”™è¯¯
      return Promise.reject(new Error('Authorization token is missing!'));
    }
    return config;
  },
  (error) => {
    return Promise.reject(error);
  }
);

// å“åº”æ‹¦æˆªå™¨
instance.interceptors.response.use(
  (response) => response,
  (error) => {
    if (axios.isCancel(error)) {
      console.log('Request canceled:', error.message);
    } else {
      console.error('Request failed:', error.message);
    }
    return Promise.reject(error);
  }
);

export default instance;
```

---

### **ä½¿ç”¨ç¤ºä¾‹**

#### è¯·æ±‚æ—¶ä¼šè§¦å‘æ‹¦æˆªå™¨ï¼š

```javascript
import api from './api';

api.get('/protected-endpoint')
  .then(response => {
    console.log('Response:', response.data);
  })
  .catch(error => {
    console.error('Error:', error.message); // Authorization token is missing!
  });
```

---

### **ä¼˜åŠ¿ä¸é™åˆ¶**

#### **ä¼˜åŠ¿ï¼š**

1. **é€»è¾‘æ¸…æ™°ï¼š** åœ¨è¯·æ±‚æœªå‘é€ä¹‹å‰å°±å¯ä»¥ä¸­æ–­ï¼Œæé«˜æ€§èƒ½ã€‚
2. **é›†ä¸­ç®¡ç†ï¼š** åœ¨è¯·æ±‚æ‹¦æˆªå™¨ä¸­ç»Ÿä¸€å¤„ç†å‚æ•°éªŒè¯ã€æƒé™æ ¡éªŒç­‰é€»è¾‘ã€‚

#### **é™åˆ¶ï¼š**

1. **éçœŸæ­£çš„è¯·æ±‚å–æ¶ˆï¼š** ä½¿ç”¨ `Promise.reject` åªæ˜¯é˜»æ­¢äº†è¯·æ±‚é€»è¾‘çš„ç»§ç»­ï¼Œä½†æµè§ˆå™¨å’Œ Axios å¹¶æœªå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚å¦‚æœä½ éœ€è¦çœŸæ­£ä¸­æ–­è¯·æ±‚ï¼Œåº”ä½¿ç”¨ `AbortController` æˆ– `CancelToken`ã€‚
2. **éœ€è¦å¼€å‘è€…å¤„ç†é”™è¯¯ï¼š** æ¯ä¸ªå‘èµ·è¯·æ±‚çš„åœ°æ–¹éƒ½éœ€è¦æ­£ç¡®å¤„ç†è¢«æ‹¦æˆªçš„é”™è¯¯ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´æœªæ•è·çš„é”™è¯¯ã€‚

---

### **å¦‚ä½•é€‰æ‹©ï¼Ÿ**

- **é€»è¾‘ä¸­æ–­ï¼š** å¦‚æœåªæ˜¯ç®€å•åœ°åœ¨æ¡ä»¶ä¸æ»¡è¶³æ—¶åœæ­¢è¯·æ±‚é€»è¾‘ï¼Œ`Promise.reject` æ˜¯ä¸€ç§ç®€æ´çš„æ–¹å¼ã€‚
- **ç½‘ç»œå±‚ä¸­æ–­ï¼š** å¦‚æœè¯·æ±‚å·²ç»å‘å‡ºå¹¶å¸Œæœ›ä¸­æ­¢å®ƒï¼Œæ¨èä½¿ç”¨ `AbortController` æˆ– `CancelToken`ã€‚

ç»“åˆåœºæ™¯ï¼Œä¸¤è€…å¯ä»¥çµæ´»é…åˆä½¿ç”¨ï¼Œæ—¢ä¿è¯é€»è¾‘ä¸Šçš„æ ¡éªŒï¼Œåˆèƒ½åœ¨å¿…è¦æ—¶å®ç°çœŸæ­£çš„ç½‘ç»œä¸­æ–­ã€‚







	é—®ï¼šæˆ‘æœ‰ç‚¹æ··ä¹±ï¼Œæ„æ€æ˜¯å¦ä¸ºï¼šåœ¨axiosçš„è¯·æ±‚æ‹¦æˆªå™¨ä¸­ä½¿ç”¨return Promise.rejectï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¯·æ±‚å‘èµ·ä¹‹å‰è¿›è¡Œæ‹¦æˆªï¼Œè€Œæ— æ³•æ‹¦æˆªå·²ç»å‘èµ·çš„è¯·æ±‚ï¼Œè€Œå¯¹äºå·²ç»å‘èµ·çš„è¯·æ±‚ï¼Œåªèƒ½é€šè¿‡AbortControlleræˆ–CancelTokenæ¥ä¸­æ–­ï¼Ÿ

ï¼šæ˜¯çš„ï¼Œæ‚¨çš„ç†è§£æ˜¯å®Œå…¨æ­£ç¡®çš„ï¼ä»¥ä¸‹æ˜¯æ›´æ¸…æ™°çš„è§£é‡Šï¼š

---

### **1. ä½¿ç”¨ `return Promise.reject` çš„æ‹¦æˆªæ–¹å¼**

- **å·¥ä½œåŸç†ï¼š**  
    åœ¨ **è¯·æ±‚æ‹¦æˆªå™¨** ä¸­ï¼Œ`return Promise.reject` ä¼šç›´æ¥ç»ˆæ­¢è¯·æ±‚çš„å‘é€é€»è¾‘ã€‚æ­¤æ—¶ï¼Œ**è¯·æ±‚å¹¶æœªçœŸæ­£å‘èµ·åˆ°æœåŠ¡å™¨**ã€‚  
    å®ƒæ˜¯é€»è¾‘ä¸Šçš„æ‹¦æˆªï¼Œç”¨äºåœ¨æ»¡è¶³ç‰¹å®šæ¡ä»¶æ—¶é˜»æ­¢ä¸å¿…è¦çš„è¯·æ±‚ã€‚
    
- **é€‚ç”¨åœºæ™¯ï¼š**
    
    - å‚æ•°æ ¡éªŒå¤±è´¥ã€‚
    - ç”¨æˆ·æœªç™»å½•æˆ–æƒé™ä¸è¶³ã€‚
    - é’ˆå¯¹æŸäº›åœºæ™¯éœ€è¦ç«‹å³è¿”å›é”™è¯¯ï¼Œè€Œæ— éœ€è§¦å‘è¯·æ±‚ã€‚
- **é™åˆ¶ï¼š**  
    å®ƒä¸èƒ½ç”¨äºå–æ¶ˆ **å·²ç»å‘é€åˆ°æœåŠ¡å™¨çš„è¯·æ±‚**ã€‚
    

---

### **2. ä½¿ç”¨ `AbortController` æˆ– `CancelToken` ä¸­æ–­å·²å‘å‡ºçš„è¯·æ±‚**

- **å·¥ä½œåŸç†ï¼š**  
    è¿™äº›æ–¹æ³•å¯ä»¥åœ¨è¯·æ±‚å·²ç»å‘èµ·åï¼Œé€šè¿‡ä¸­æ–­ä¿¡å·ï¼ˆ`AbortController.signal` æˆ– `CancelToken`ï¼‰é€šçŸ¥ Axios åœæ­¢è¯·æ±‚çš„æ‰§è¡Œï¼Œå¹¶æŠ›å‡ºä¸€ä¸ªå–æ¶ˆé”™è¯¯ã€‚
    
- **é€‚ç”¨åœºæ™¯ï¼š**
    
    - ç”¨æˆ·å¿«é€Ÿåˆ‡æ¢é¡µé¢ï¼Œéœ€è¦å–æ¶ˆæœªå®Œæˆçš„è¯·æ±‚ï¼ˆä¾‹å¦‚åœ¨ç»„ä»¶é”€æ¯æ—¶ï¼‰ã€‚
    - é¿å…åŒä¸€èµ„æºé‡å¤è¯·æ±‚ï¼Œå–æ¶ˆä¸Šä¸€ä¸ªæœªå®Œæˆçš„è¯·æ±‚ã€‚
    - ç½‘ç»œä¸ç¨³å®šæˆ–è¶…æ—¶åä¸»åŠ¨ä¸­æ–­è¯·æ±‚ã€‚

---

### **æ€»ç»“åŒºåˆ«**

|**æ–¹å¼**|**è¯·æ±‚æ˜¯å¦å‘å‡ºåˆ°æœåŠ¡å™¨**|**å®ç°æ–¹æ³•**|**æ¨èä½¿ç”¨åœºæ™¯**|
|---|---|---|---|
|`return Promise.reject`|è¯·æ±‚æœªå‘å‡º|è¯·æ±‚æ‹¦æˆªå™¨ä¸­é€»è¾‘æ‹¦æˆª|å‚æ•°æ ¡éªŒã€æƒé™ä¸è¶³ç­‰é€»è¾‘æ‹¦æˆª|
|`AbortController`|è¯·æ±‚å¯èƒ½å·²å‘å‡º|ä¿¡å·ä¸­æ–­æœºåˆ¶|é¡µé¢åˆ‡æ¢ã€ç»„ä»¶é”€æ¯ã€é¿å…é‡å¤è¯·æ±‚|
|`CancelToken`|è¯·æ±‚å¯èƒ½å·²å‘å‡º|è¿‡æ—¶çš„ä¸­æ–­æœºåˆ¶|åŒä¸Šï¼ˆä»…åœ¨ä½¿ç”¨æ—§ç‰ˆ Axios æ—¶ä½¿ç”¨ï¼‰|

---

### **ä»£ç ç¤ºä¾‹å¯¹æ¯”**

#### **é€»è¾‘æ‹¦æˆªï¼ˆè¯·æ±‚æœªå‘å‡ºï¼‰**

```javascript
axios.interceptors.request.use((config) => {
    if (!config.headers['Authorization']) {
        // é€»è¾‘æ‹¦æˆªï¼šè¯·æ±‚æœªå‘å‡º
        return Promise.reject(new Error('Authorization token is missing!'));
    }
    return config;
});
```

#### **ç½‘ç»œä¸­æ–­ï¼ˆè¯·æ±‚å¯èƒ½å·²å‘å‡ºï¼‰**

```javascript
const controller = new AbortController();

axios.get('/your-endpoint', { signal: controller.signal })
    .then(response => console.log(response))
    .catch(error => {
        if (error.name === 'CanceledError') {
            console.log('Request canceled');
        } else {
            console.error(error);
        }
    });

// ä¸­æ–­è¯·æ±‚
controller.abort();
```

---

å¸Œæœ›è¿™ä¸ªæ›´æ¸…æ™°çš„è§£é‡Šèƒ½è§£ç­”æ‚¨çš„ç–‘æƒ‘ï¼å¦‚æœè¿˜æœ‰å…¶ä»–é—®é¢˜ï¼Œå¯ä»¥ç»§ç»­è®¨è®ºï¼ ğŸ˜Š